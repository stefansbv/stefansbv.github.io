<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width">

  <title>
    
      The PlannedCopy Application &middot; Ștefan Suciu&#39;s Blog
    
  </title>

  
  <link rel="stylesheet" href="http://stefansuciu.ro/css/poole.min.css"/>
  <link rel="stylesheet" href="http://stefansuciu.ro/css/syntax.min.css"/>
  <link rel="stylesheet" href="http://stefansuciu.ro/css/lanyon.min.css"/>
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400"/>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>
  <link rel="stylesheet" href="http://stefansuciu.ro/css/prism.min.css"/>
  <link rel="stylesheet" href="http://stefansuciu.ro/css/style.min.css"/>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://stefansuciu.ro/assets/apple-touch-icon-144-precomposed.png"/>
  <link rel="shortcut icon" href="http://stefansuciu.ro/assets/favicon.ico"/>

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://stefansuciu.ro/index.xml"/>

  
  <link rel="canonical" href="http://stefansuciu.ro/2015/12/the-plannedcopy-application/"/>
</head>


  <body class="sidebar-overlay theme-base-08">

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A technologically oriented blog with a simple design.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="http://stefansuciu.ro/posts">Home</a>
    <a class="sidebar-nav-item " href="http://stefansuciu.ro/posts">Posts</a>

    
    
      
        <a class="sidebar-nav-item " href="http://stefansuciu.ro/fixed/about/">About</a>
      
    
      
        <a class="sidebar-nav-item " href="http://stefansuciu.ro/fixed/projects/tpda3/intro/">Tpda3</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </nav>

  <div class="sidebar-item">
    
    <span class="sidebar-list-label"><p>Categories:</p></span>
    <ul class="fa-ul">
      
      <li><i class="fa-li fa fa-check-square"></i><a href="http://stefansuciu.ro//categories/projects/index.html">Projects</a></li>
    
    </ul>
  </div>

  <div class="sidebar-item">
    <p>&copy; 2016. All rights reserved.</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="http://stefansuciu.ro/" title="Home">Ștefan Suciu&#39;s Blog</a>
          </h3>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">The PlannedCopy Application</h1>

  <div class="flex-container">
    <div class="post-date">
      2015-12-14 in 
      <a href="http://stefansuciu.ro/categories/projects" class="btn btn-primary">Projects</a>
      
      <div class="tags">
        <i class="fa fa-tag"></i>
        
        <span class="muted">&middot;</span>
        <a class="tags" href="http://stefansuciu.ro/tags/perl">#perl</a>
        
        <span class="muted">&middot;</span>
        <a class="tags" href="http://stefansuciu.ro/tags/tools">#tools</a>
        
      </div>
    </div>
    <div class="post-date"> <span class="share-buttons">
	<a href="https://twitter.com/intent/tweet?source=http%3a%2f%2fstefansuciu.ro%2f2015%2f12%2fthe-plannedcopy-application%2f&text=The%20PlannedCopy%20Application:http%3a%2f%2fstefansuciu.ro%2f2015%2f12%2fthe-plannedcopy-application%2f" target="_blank" title="Tweet"><i class="fa fa-twitter-square fa-lg"></i></a>
	<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fstefansuciu.ro%2f2015%2f12%2fthe-plannedcopy-application%2f&title=The%20PlannedCopy%20Application&summary=The%20PlannedCopy%20Application&source=http%3a%2f%2fstefansuciu.ro%2f2015%2f12%2fthe-plannedcopy-application%2f" target="_blank" title="Share on LinkedIn"><i class="fa fa-linkedin-square fa-lg"></i></a>
</span>
 </div>
  </div>

  <p>PlannedCopy (plcp) is another tool from my toolbox, an automated copy
utility for Linux.</p>
<p>This is my solution for the task of managing configuration files,
scripts and other files that need to be copied around, changed and
stored in a safe place.</p>
<p>The idea behind the application is simple, but the implementation is
quite complicated&hellip; :).  I keep my configuration files, like many
others do, in a Git repository.  The task is to install this files to
the places where they belong to, as automated as possible.</p>
<p>A minimal Git repository in <code>/home/darkstar/configs</code> looks like this:</p>
<pre><code>.
├── emacs
│   ├── custom.el
│   ├── init.el
│   └── resource.yml
├── kde
│   ├── Shell.profile
│   └── resource.yml
├── linux
│   ├── ackrc
│   ├── bash_alias
│   ├── bash_profile
│   ├── bash_prompt
│   ├── bashrc
│   └── resource.yml
└── system
    ├── rc.firebird
    ├── rc.postgresql
    └── resource.yml
</code></pre><p>A <code>project</code> is a subdirectory under the root of the repository.  In
the example above there are three so called <code>projects</code>: emacs, kde,
linux and system.</p>
<p>The application uses a configuration file named <code>resource.yml</code> in each
project directory with the following information:</p>
<p>For example, an item in the <code>resource.yml</code> file looks line this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-YAML" data-lang="YAML">---
<span style="color:#66d9ef">resources</span>:
  <span style="color:#e6db74">-
</span><span style="color:#e6db74">    destination:</span>
      <span style="color:#66d9ef">name</span>: .ackrc
      <span style="color:#66d9ef">path</span>: <span style="color:#e6db74">&#39;~/&#39;</span>
      <span style="color:#66d9ef">perm</span>: <span style="color:#ae81ff">0644</span>
    <span style="color:#66d9ef">source</span>:
      <span style="color:#66d9ef">name</span>: ackrc
      <span style="color:#66d9ef">path</span>: linux
</code></pre></div><p>The <code>plcp install linux</code> command will copy and rename the
<code>linux/ackrc</code> file to <code>/home/user/.ackrc</code> and will set the permissions
to <code>0644</code>.</p>
<p>The <code>resource.yml</code> configuration file is automatically
generated/updated by the <code>plcp resu linux</code> command, but the
destination path is initially undefined and have to be edited manually
for every record.</p>
<h2 id="features">Features</h2>
<p>The features and also the commands of the application are:</p>
<p>The main commands:</p>
<ul>
<li>install - Install the files (copy files and set permissions);</li>
<li>sync    - Synchronize the configuration files - copy back to the repository;</li>
<li>check   - Compare the repository files with the installed versions;</li>
</ul>
<p>Additional helper and info commands:</p>
<ul>
<li>config  - Configure the application;</li>
<li>repo    - Manage the repository (clone only for now);</li>
<li>resu    - Manage the resource config files (create/update);</li>
<li>diff    - Run a diff utility on the repo files and the installed versions;</li>
<li>list    - Print a list of the projects in the repository;</li>
<li>version - Print the current version;</li>
</ul>
<p>The <code>install</code> and <code>sync</code> commands take an optional file name used for
limiting the command to that specific file.  The</p>
<p>Another feature, in the devel branch, is an optional project parameter
for the <code>list</code> command, to print the files in the directory.</p>
<h2 id="installation">Installation</h2>
<p>This is a Perl application built with Moose and
<a href="https://metacpan.org/pod/MooseX::App">MooseX::App</a> and Dist::Zilla.
It has many dependencies, so it&rsquo;s not easy to install from source, but
I will provide a package made with Cava Packager for the next release.</p>
<p>Update: Done, see the releases on GitHub.</p>
<h2 id="quick-usage">Quick Usage</h2>
<p>The initial configuration of <code>plcp</code>:</p>
<pre><code>$ plcp config set --url ssh://user@host/path/git-repos/configs.git
$ plcp config set --path /home/user/configs
</code></pre><p>Clone the repository in the HOME dir:</p>
<pre><code>$ plcp repo clone
</code></pre><p>Add/update the <code>resource.yml</code> file in the <code>emacs</code> directory using:</p>
<pre><code>$ plcp resu emacs
</code></pre><p>Edit the <code>emacs/resource.yml</code> file and set the destination path for
all the items.</p>
<p>Finally install the files with:</p>
<pre><code>$ plcp install emacs
</code></pre><p>The project is &ldquo;work in progress&rdquo; on
<a href="https://github.com/stefansbv/planned-copy">GitHub</a> and is open
source.  I use it almost every day, but it has a few known bugs and
probably many unknown bugs.</p>
  


  

<div id="disqus_thread"></div>
<script type="text/javascript">
(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'stefansuciu';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>



</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62428437-1', 'auto');
  ga('send', 'pageview');

</script>



    
    <script src="http://stefansuciu.ro/js/main.min.js"></script>

  </body>
</html>

